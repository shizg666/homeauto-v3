<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.landleaf.homeauto.center.device.model.mapper.HomeAutoProjectMapper">

    <select id="countByRealestateId" resultType="com.landleaf.homeauto.common.domain.vo.realestate.RealestateCountBO">
        SELECT
			realestate_id,
			COUNT ( 1 )
		FROM
			home_auto_project
		WHERE
			realestate_id IN
				<foreach collection="ids" index="index" item="item" open="(" close=")" separator=",">
					#{item}
				</foreach>
		GROUP BY
			realestate_id
    </select>

	<select id="page" resultType="com.landleaf.homeauto.common.domain.vo.realestate.ProjectVO">
		SELECT
		p.id,
		P.NAME,
			P.TYPE,
			re.NAME AS realestateName,
			re.id AS realestateId,
			re.developer_name,
			re.path_name
		FROM
			home_auto_realestate re,
			home_auto_project P
		WHERE
			re.ID = P.realestate_id

		<if test="type!=null and type!=''">
			AND p.TYPE=#{type}
		</if>
		<if test="developerCode!=null and developerCode!=''">
			AND re.developer_code = ''
		</if>
		<if test="name!=null and name!=''">
			AND p.NAME like '%${name}%'
		</if>
		<if test="realestateId!=null and realestateId!=''">
			AND re.id = #{realestateId}
		</if>
		order by p.create_time desc

	</select>
</mapper>
